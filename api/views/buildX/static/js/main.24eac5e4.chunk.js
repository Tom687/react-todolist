(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{35:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},58:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},67:function(t,e,n){},68:function(t,e,n){},69:function(t,e,n){},70:function(t,e,n){},71:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n(0),o=n.n(r),a=n(13),i=n.n(a),s=(n(35),n(2)),u=(n(36),n(37),n(38),n(4)),l=n.n(u),d=n(9),f=n(7),j=n.n(f),b=(n(58),n(5)),O=n(11),p=n(14),x="SHOW_ALL",h="SHOW_COMPLETED",v="SHOW_ACTIVE",m=Object(O.b)({name:"filters",initialState:x,reducers:{setVisibilityFilter:function(t,e){return e.payload}}}),k=m.actions,g=m.reducer,y=k.setVisibilityFilter,w=g,E=Object(O.b)({name:"todos",initialState:[],reducers:{addTodo:function(t,e){var n=e.payload,c=n.id,r=n.text;console.log("redux ID",c),t.push({id:c,text:r,completed:!1})},addTodosFromDB:function(t,e){var n=e.payload,c=n.id,r=n.title,o=n.status;o="fait"===o,t.push({id:c,text:r,completed:o})},toggleTodo:function(t,e){var n=t.find((function(t){return t.id===e.payload}));n&&(n.completed=!n.completed)},toggleAllTodos:function(t,e){var n=t.every((function(t){return t.completed}));t.map((function(t){return t.completed=!n}))},editTodo:function(t,e){var n=t.find((function(t){return t.id===e.payload.id}));n&&(n.text=e.payload.text)},removeTodo:function(t,e){return t.filter((function(t){return t.id!==e.payload}))}}}),C=function(t){return t.todos},T=Object(p.a)([C,function(t){return t.filters}],(function(t,e){switch(e){case x:return t;case v:return t.filter((function(t){return!t.completed}));case h:return t.filter((function(t){return t.completed}));default:throw new Error("Unknown filter : ".concat(e))}})),S=Object(p.a)([C],(function(t){return t.filter((function(t){return!t.completed})).length})),N=E.actions,D=E.reducer,F=N.addTodo,L=N.addTodosFromDB,A=N.toggleTodo,B=N.toggleAllTodos,R=N.editTodo,_=N.removeTodo,I=D,H=function(){var t=Object(r.useState)(""),e=Object(s.a)(t,2),n=e[0],o=e[1],a=Object(b.b)();function i(){return(i=Object(d.a)(l.a.mark((function t(e){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),n.trim()){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,j.a.post("http://localhost:3000/todos",{title:n.trim(),completed:n.completed});case 6:"success"!==(c=t.sent).data.status&&201!==c.status||(console.log("res id",c.data.id),a(F({text:n.trim(),id:c.data.id})),o("")),console.log("res",c),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("ERROR SUBMIT TODO BACKEND : ",t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))).apply(this,arguments)}return Object(c.jsxs)("div",{className:"todos-header",children:[Object(c.jsx)("button",{className:"toggle-all-todos",onClick:function(){return a(B())},children:"\u276f"}),Object(c.jsx)("form",{onSubmit:function(t){return function(t){return i.apply(this,arguments)}(t)},id:"add-todo-form",className:"add-todo-form",children:Object(c.jsx)("input",{type:"text",placeholder:"Ajouter une chose \xe0 faire",id:"add-todo-input",className:"add-todo-input",name:"todo",onChange:function(t){return o(t.target.value)},value:n})})]})},M=n(28),K=n(29),P=(n(65),n(8)),V=(n(66),n(67),function(t){var e=t.onClick,n=t.done,o=Object(r.useState)(!1),a=Object(s.a)(o,2),i=a[0],u=a[1];function l(){console.log("ISCHECKED",i,"DONE",n),u(!!n&&(!n&&!i&&!i))}return Object(c.jsxs)("div",{className:Object(P.a)("custom-checkbox-container"),onClick:e,children:[Object(c.jsx)("input",{type:"checkbox",checked:i,onChange:function(){return l()},className:Object(P.a)("custom-checkbox")}),Object(c.jsx)("span",{className:Object(P.a)("custom-visible-checkbox",{checked:i||n}),onClick:function(){return l()}})]})}),W=function(t){t.id,t.text;var e=t.todo,n=Object(b.b)(),o=Object(r.useState)(!1),a=Object(s.a)(o,2),i=a[0],u=a[1],f=Object(r.useState)(e.text),O=Object(s.a)(f,2),p=O[0],x=O[1],h=function(){var t=Object(d.a)(l.a.mark((function t(c){var r,o,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.trim(),!i){t.next=21;break}if(t.prev=2,13!==c.which&&"blur"!==c.nativeEvent.type){t.next=16;break}if(0!==r.length){t.next=11;break}return t.next=7,j.a.delete("http://localhost:3000/todos/"+e.id);case 7:200!==(o=t.sent).status&&"success"!==o.data.status||(console.log("removed success",o.data),n(_(e.id))),t.next=15;break;case 11:return t.next=13,j.a.put("http://localhost:3000/todos/"+e.id,{title:r.trim()});case 13:200!==(a=t.sent).status&&"success"!==a.data.status||(console.log("edit success",a.data),n(R({id:e.id,text:r.trim()})));case 15:u(!1);case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2),console.error("Err edit todo",t.t0);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(d.a)(l.a.mark((function t(){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.delete("http://localhost:3000/todos/"+e.id);case 3:200!==(c=t.sent).status&&"success"!==c.data.status||n(_(e.id)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Err deleteTodo",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Object(d.a)(l.a.mark((function t(){var c,r,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c=e.completed?"non":"fait",r="fait"===c?new Date:null,t.next=5,j.a.put("http://localhost:3000/todos/"+e.id,{status:c,done_on:r});case 5:200!==(o=t.sent).status&&"success"!==o.data.status||n(A(e.id)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Err changeTodoStatus",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();return i?Object(c.jsx)("li",{className:Object(P.a)("todo-item","editing"),children:Object(c.jsx)("input",{type:"text",value:p,onChange:function(t){return x(t.target.value)},onBlur:function(t){return h(t)},autoFocus:!0,onKeyDown:function(t){return h(t)}})}):Object(c.jsxs)("li",{className:Object(P.a)("todo-item",{done:e.completed}),children:[Object(c.jsx)(V,{onClick:function(){return m()},done:e.completed}),Object(c.jsx)("label",{onDoubleClick:function(){return u(!0)},children:e.text}),Object(c.jsx)("button",{className:"delete-todo",onClick:function(){return v()},children:"\xd7"})]})},J=function(){var t=Object(b.b)(),e=Object(b.c)(T),n=function(){var n=Object(d.a)(l.a.mark((function n(){var c,r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.get("http://localhost:3000/todos");case 3:if(200===(c=n.sent).status||"success"===c.data.status)for(r in e=c.data.todos)t(L(e[r]));n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("ERR GETDBTODOS",n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();Object(r.useEffect)((function(){n()}),[]);var o=function(t,n){var c,r=Object(K.a)(e),o=Object(M.a)(r);try{for(o.s();!(c=o.n()).done;){var a=c.value;a.id===t&&(a.text=n)}}catch(i){o.e(i)}finally{o.f()}};return Object(c.jsx)("div",{className:"todolist-container",children:Object(c.jsx)("ul",{className:"todo-list",children:e.map((function(t){return Object(c.jsx)(W,{id:t.id,text:t.text,edit:o,todo:t},t.id)}))})})},U=(n(68),n(69),function(t){var e=t.filter,n=t.onClick,r=t.activeFilter,o=t.children;return Object(c.jsx)("button",{onClick:n,className:Object(P.a)("filter-link",{active:r===e}),children:o})}),G=function(){var t=Object(r.useState)(null),e=Object(s.a)(t,2),n=e[0],o=e[1],a=Object(b.b)(),i=Object(b.c)(S),u=i>1?"t\xe2ches restantes":"t\xe2che restante";function l(t){o(t),a(y(t))}return Object(c.jsxs)("div",{className:"footer",children:[Object(c.jsxs)("span",{className:"undone-todos",children:[i||"Aucune"," ",u]}),Object(c.jsxs)("div",{className:"filters",children:[Object(c.jsx)(U,{filter:x,onClick:function(){return l(x)},activeFilter:n,children:"Tous"}),Object(c.jsx)(U,{filter:h,onClick:function(){return l(h)},activeFilter:n,children:"Faits"}),Object(c.jsx)(U,{filter:v,onClick:function(){return l(v)},activeFilter:n,children:"A faire"})]})]})};var q=function(t){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),c=n[0],o=n[1];function a(e){console.log("key",e),console.log("ke{\xf8y",{key:e}),e===t&&o(!0)}var i=function(e){e.key===t&&o(!1)};return Object(r.useEffect)((function(){return window.addEventListener("keydown",a),window.addEventListener("keyup",i),function(){window.removeEventListener("keydown",a),window.removeEventListener("keyup",i)}}),[]),c};var z=function(t,e){Object(r.useEffect)((function(){var n=function(n){t.current&&!t.current.contains(n.target)&&e(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[t,e])};n(70);var Q=function(t){var e=Object(r.useState)(!1),n=Object(s.a)(e,2),o=n[0],a=n[1],i=Object(r.useState)(t.text),u=Object(s.a)(i,2),l=u[0],d=u[1],f=Object(r.useRef)(null),j=Object(r.useRef)(null),b=Object(r.useRef)(null),O=q("Enter"),p=q("Escape"),x=t.onSetText;z(f,(function(){o&&(t.onSetText(l),a(!1))}));var h=Object(r.useCallback)((function(){O&&(x(l),a(!1))}),[O,l,x]),v=Object(r.useCallback)((function(){p&&(d(t.text),a(!1))}),[p,l,x]);Object(r.useEffect)((function(){o&&b.current.focus()}),[o]),Object(r.useEffect)((function(){o&&(h(),v())}),[h,v,o]);var m=Object(r.useCallback)((function(){return a(!0)}),[a]);return Object(c.jsxs)("span",{className:"inline-text",ref:f,children:[Object(c.jsx)("span",{ref:j,onClick:m,className:"inline-text_copy inline-text_copy--".concat(o?"hidden":"active"),children:t.text}),Object(c.jsx)("input",{ref:b,style:{width:Math.ceil(.9*l.length)+"ex"},value:l,onChange:function(t){d(t.target.value)},className:"inline-text_input inline-text_input--".concat(o?"active":"hidden")})]})};var X=function(){var t=Object(r.useState)("Click here to start editing the text!"),e=Object(s.a)(t,2),n=e[0],o=e[1],a=Object(r.useState)("Here's some more, edit away!"),i=Object(s.a)(a,2),u=i[0],l=i[1];return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("div",{className:"todos",children:[Object(c.jsx)("h2",{children:Object(c.jsx)(Q,{text:n,onSetText:function(t){return o(t)}})}),Object(c.jsx)("p",{children:Object(c.jsx)(Q,{text:u,onSetText:function(t){return l(t)}})}),Object(c.jsx)(H,{}),Object(c.jsx)(J,{}),Object(c.jsx)(G,{})]})})},Y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,72)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),c(t),r(t),o(t),a(t)}))},Z=Object(O.a)({reducer:{todos:I,filters:w}});i.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(b.a,{store:Z,children:Object(c.jsx)(X,{})})}),document.getElementById("root")),Y()}},[[71,1,2]]]);
//# sourceMappingURL=main.24eac5e4.chunk.js.map