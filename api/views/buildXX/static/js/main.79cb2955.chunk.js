(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{26:function(t,e,n){},34:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},57:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},67:function(t,e,n){},68:function(t,e,n){"use strict";n.r(e);var c=n(1),r=n(0),o=n.n(r),a=n(11),i=n.n(a),s=(n(34),n(2)),u=n.n(s),l=n(5),d=n(4),f=(n(36),n(37),n(38),n(3)),b=n.n(f),j=(n(57),n(6)),p=n(10),O=n(12),h="SHOW_ALL",v="SHOW_COMPLETED",m="SHOW_ACTIVE",x=Object(p.b)({name:"filters",initialState:h,reducers:{setVisibilityFilter:function(t,e){return e.payload}}}),k=x.actions,g=x.reducer,w=k.setVisibilityFilter,E=g,y=Object(p.b)({name:"todos",initialState:[],reducers:{addTodo:function(t,e){var n=e.payload,c=n.id,r=n.text;console.log("redux ID",c),t.push({id:c,text:r,completed:!1})},addTodosFromDB:function(t,e){var n=e.payload,c=n.id,r=n.title,o=n.status;o="fait"===o,t.push({id:c,text:r,completed:o})},toggleTodo:function(t,e){var n=t.find((function(t){return t.id===e.payload}));n&&(n.completed=!n.completed)},toggleAllTodos:function(t,e){var n=t.every((function(t){return t.completed}));t.map((function(t){return t.completed=!n}))},editTodo:function(t,e){var n=t.find((function(t){return t.id===e.payload.id}));n&&(n.text=e.payload.text)},removeTodo:function(t,e){return t.filter((function(t){return t.id!==e.payload}))}}}),C=function(t){return t.todos},T=Object(O.a)([C,function(t){return t.filters}],(function(t,e){switch(e){case h:return t;case m:return t.filter((function(t){return!t.completed}));case v:return t.filter((function(t){return t.completed}));default:throw new Error("Unknown filter : ".concat(e))}})),N=Object(O.a)([C],(function(t){return t.filter((function(t){return!t.completed})).length})),S=y.actions,D=y.reducer,F=S.addTodo,L=S.addTodosFromDB,A=S.toggleTodo,_=S.toggleAllTodos,B=S.editTodo,R=S.removeTodo,I=D,H=function(){var t=Object(r.useState)(""),e=Object(d.a)(t,2),n=e[0],o=e[1],a=Object(j.b)();function i(){return(i=Object(l.a)(u.a.mark((function t(e){var c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),n.trim()){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,b.a.post("http://localhost:3000/todos",{title:n.trim(),completed:n.completed});case 6:"success"!==(c=t.sent).data.status&&201!==c.status||(console.log("res id",c.data.id),a(F({text:n.trim(),id:c.data.id})),o("")),console.log("res",c),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("ERROR SUBMIT TODO BACKEND : ",t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))).apply(this,arguments)}return Object(c.jsxs)("div",{className:"todos-header",children:[Object(c.jsx)("button",{className:"toggle-all-todos",onClick:function(){return a(_())},children:"\u276f"}),Object(c.jsx)("form",{onSubmit:function(t){return function(t){return i.apply(this,arguments)}(t)},id:"add-todo-form",className:"add-todo-form",children:Object(c.jsx)("input",{type:"text",placeholder:"Ajouter une chose \xe0 faire",id:"add-todo-input",className:"add-todo-input",name:"todo",onChange:function(t){return o(t.target.value)},value:n})})]})},M=n(28),P=(n(64),n(9)),V=(n(26),n(65),function(t){var e=t.onClick,n=t.done,o=Object(r.useState)(!1),a=Object(d.a)(o,2),i=a[0],s=a[1];function u(){console.log("ISCHECKED",i,"DONE",n),s(!!n&&(!n&&!i&&!i))}return Object(c.jsxs)("div",{className:Object(P.a)("custom-checkbox-container"),onClick:e,children:[Object(c.jsx)("input",{type:"checkbox",checked:i,onChange:function(){return u()},className:Object(P.a)("custom-checkbox")}),Object(c.jsx)("span",{className:Object(P.a)("custom-visible-checkbox",{checked:i||n}),onClick:function(){return u()}})]})});var W=function(t){var e=Object(r.useState)(!1),n=Object(d.a)(e,2),c=n[0],o=n[1];function a(e){e.key===t&&o(!0)}var i=function(e){e.key===t&&o(!1)};return Object(r.useEffect)((function(){return window.addEventListener("keydown",a),window.addEventListener("keyup",i),function(){window.removeEventListener("keydown",a),window.removeEventListener("keyup",i)}}),[]),c};var J=function(t,e){Object(r.useEffect)((function(){var n=function(n){t.current&&!t.current.contains(n.target)&&e(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[t,e])},K=function(t){var e=t.id,n=t.text,o=t.todo,a=t.onEditingTodo,i=Object(j.b)(),s=Object(r.useState)(!1),f=Object(d.a)(s,2),p=f[0],O=f[1],h=Object(r.useState)(n),v=Object(d.a)(h,2),m=v[0],x=v[1],k=Object(r.useRef)(null),g=Object(r.useRef)(null),w=W("Enter"),E=W("Escape");J(k,(function(){p&&(m.trim()!==o.text&&(a(e,m.trim()),N(m.trim())),O(!1))}));var y=Object(r.useCallback)((function(){w&&(m.trim()!==o.text&&(a(e,m.trim()),N(m.trim())),O(!1))}),[w,m,a]),C=Object(r.useCallback)((function(){E&&(x(n),O(!1))}),[E,m,a]);Object(r.useEffect)((function(){p&&g.current.focus()}),[p]),Object(r.useEffect)((function(){p&&(y(),C())}),[y,C,p]);var T=Object(r.useCallback)((function(){return O(!0)}),[O]),N=Object(r.useCallback)(function(){var t=Object(l.a)(u.a.mark((function t(e){var n,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,0!==e.length){t.next=8;break}return t.next=4,b.a.delete("http://localhost:3000/todos/"+o.id);case 4:200!==(n=t.sent).status&&"success"!==n.data.status||i(R(o.id)),t.next=12;break;case 8:return t.next=10,b.a.put("http://localhost:3000/todos/"+o.id,{title:e.trim()});case 10:200!==(c=t.sent).status&&"success"!==c.data.status||console.log("edit success",c.data);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error("Err edit todo",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),[]),S=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.delete("http://localhost:3000/todos/"+o.id);case 3:200!==(e=t.sent).status&&"success"!==e.data.status||i(R(o.id)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Err deleteTodo",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),D=function(){var t=Object(l.a)(u.a.mark((function t(){var e,n,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=o.completed?"non":"fait",n="fait"===e?new Date:null,t.next=5,b.a.put("http://localhost:3000/todos/"+o.id,{status:e,done_on:n});case 5:200!==(c=t.sent).status&&"success"!==c.data.status||i(A(o.id)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Err changeTodoStatus",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();return Object(c.jsxs)("li",{ref:k,className:Object(P.a)("todo-item",{done:o.completed},{editing:p}),children:[Object(c.jsx)(V,{onClick:function(){return D()},done:o.completed}),Object(c.jsx)("label",{onDoubleClick:T,className:"inline-text_copy inline-text_copy--".concat(p?"hidden":"active"),children:o.text}),Object(c.jsx)("input",{ref:g,value:m,onChange:function(t){return x(t.target.value)},className:"inline-text_input inline-text_input--".concat(p?"active":"hidden")}),Object(c.jsx)("button",{className:"delete-todo",onClick:function(){return S()},children:"\xd7"})]})},U=function(){var t=Object(j.b)(),e=Object(j.c)(T),n=function(){var n=Object(l.a)(u.a.mark((function n(){var c,r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.get("http://localhost:3000/todos");case 3:if(200===(c=n.sent).status||"success"===c.data.status)for(r in e=c.data.todos)t(L(e[r]));n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error("ERR GETDBTODOS",n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();Object(r.useEffect)((function(){n()}),[]);return Object(c.jsx)("div",{className:"todolist-container",children:Object(c.jsx)("ul",{className:"todo-list",children:e.map((function(n){return Object(c.jsx)(K,{id:n.id,text:n.text,onEditingTodo:function(n,c){return function(n,c){var r,o=Object(M.a)(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.id===n&&a.text!==c&&t(B({id:n,text:c}))}}catch(i){o.e(i)}finally{o.f()}}(n,c)},todo:n},n.id)}))})})},G=(n(66),n(67),function(t){var e=t.filter,n=t.onClick,r=t.activeFilter,o=t.children;return Object(c.jsx)("button",{onClick:n,className:Object(P.a)("filter-link",{active:r===e}),children:o})}),q=function(){var t=Object(r.useState)(null),e=Object(d.a)(t,2),n=e[0],o=e[1],a=Object(j.b)(),i=Object(j.c)(N),s=i>1?"t\xe2ches restantes":"t\xe2che restante";function u(t){o(t),a(w(t))}return Object(c.jsxs)("div",{className:"footer",children:[Object(c.jsxs)("span",{className:"undone-todos",children:[i||"Aucune"," ",s]}),Object(c.jsxs)("div",{className:"filters",children:[Object(c.jsx)(G,{filter:h,onClick:function(){return u(h)},activeFilter:n,children:"Tous"}),Object(c.jsx)(G,{filter:v,onClick:function(){return u(v)},activeFilter:n,children:"Faits"}),Object(c.jsx)(G,{filter:m,onClick:function(){return u(m)},activeFilter:n,children:"A faire"})]})]})};var z=function(){var t=Object(r.useState)("Click here to start editing the text!"),e=Object(d.a)(t,2),n=(e[0],e[1],Object(r.useState)("Here's some more, edit away!")),o=Object(d.a)(n,2),a=(o[0],o[1],function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/logout");case 2:e=t.sent,console.log("logout res",e),setTimeout((function(){return window.location.replace("http://localhost:3000/connexion")}),5e3);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}());return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("div",{className:"todos",children:[Object(c.jsx)("button",{onClick:function(){return a()},children:"Logout"}),Object(c.jsx)(H,{}),Object(c.jsx)(U,{}),Object(c.jsx)(q,{})]})})},Q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,69)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),c(t),r(t),o(t),a(t)}))},X=Object(p.a)({reducer:{todos:I,filters:E}});i.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(j.a,{store:X,children:Object(c.jsx)(z,{})})}),document.getElementById("root")),Q()}},[[68,1,2]]]);
//# sourceMappingURL=main.79cb2955.chunk.js.map